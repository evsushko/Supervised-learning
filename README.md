# Supervised-learning
## Задача проекта
Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. 
Задача: разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность. 

>Нам были переданы данные в таблицах:
>
>*market_file.csv - о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.
>*market_money.csv - с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.
>*market_time.csv - с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода.

В данном проекте были рассмотрены данные о покупателях интернет-магазина, их поведении на сайте магазина и их покупках. Объем данных был представлен в четырех таблицах.

## Цель проекта
Цель проекта - научиться предсказывать активность покупателей в последующие месяцы, вероятность ее снижения. Также нужно было выбрать сегмент покупателей, проанализировать его и предложить меры по повышению вероятности того, что активность покупателей из данного сегмента не снизится.

## Модели анализа
Использованы следующие модели анализа:
-Исследовательский анализ
-Корреляционный анализ
-Машинное обучение
-Анализ важности признаков
-Сегментация покупателей и рекомендации для выбранного сегмента.


Ниже представлены результаты каждой модели подробнее:

### Результаты исследовательского анализа

-Покупателей с низкой покупательской активностью меньше, чем покупателей с прежним уровнем активности
-Премиум сервис у меньшего количества покупателей (около 30% покупателей)
-Все покупатели зарегистрированы более 100 дней, среднее количество покупателей зарегистрировано около 600 дней, встречаются и те, кто зарегистрирован более 1000 дней, но их не много.
-В большинстве случаев продукты по акции при покупке составляют 20-30% от заказа.
-Больше всего покупают товары для детей, Домашний текстиль и косметику/аксессуары. Самая низко продаваемая категория среди представленных - кухонная посуда.
-Покупатель смотрит 2-3 категории за визит в течение последнего месяца. Одну категорию вероятно смотрят те, кто знает, что именно надо купить, а 6 категорий интересны для тех, кто зашел "посмотреть" - их меньше всех.
-Количество неоплаченных продуктов составляет 1-3 единицы за квартал у клиента.
-Сбои в количестве 4 раз коснулись покупателя во время посещения сайта - самый распространенный показатель ошибок сервиса. Расстраивает, что есть показатели и в 8-9 ошибок. Количество посетителей с такими данными мало, но это знак на то, что над техническим сопровождением надо работать, так как ошибки сервиса раздражают обычно покупателя. Таким образом теряются клиенты и отзывы о работе сервиса не будут положительными.
-В среднем покупатель за один визит просматривает от 3 до 12 страниц в течение последнего месяца.
Для дальнейшей работы данные объединили в итоговую таблицу и оставили параметры только 1296 покупателей, ежемесячная выручка от которых за последние 3 месяца была больше 0.

### Результаты корреляционного анализа
Провели корреляционный анализ. Обнаружили высокую коллинеарность между параметрами "выручка_предыдущий_период" и "выручка_текущий_период". Исключили последний параметр из данных для машинного обучения.

### Результаты машинного обучения
Провели машинное обучение, случайным образом выбирая из четырех типов моделей (KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и SVC()) и их гиперпараметров. Также меняли способ масштабирования данных (скейлер) на этапе их подготовки перед обучением моделей.

В качестве метрики для оценки качества модели использовали метрику "roc_auc". Метрику используют, когда необходимо оценить качество работы модели вне зависимости от выбранного порога вероятности. Метрику можно использовать также в случае, когда объектов с одним значением целевого признака больше, чем с другими. У нас именно такая ситуация (активных покупателей 62%, неактивных - 38%).
Самой лучшей моделью оказалась модель логистической регрессии с гиперпараметром С=1. Метрика на тестовой выборке для нее равна 0.9.

### Результаты анализа важности признаков
Провели анализ важности признаков с помощью shap.
Самый влиятельный параметр - количество просмотренных страниц за визит. Если у наблюдения высокое значение этого признака, то у него высокая вероятность принадлежности к классу 1, то есть активность покупателя останется прежней.
Менее влиятельные параметры - количество проведенных на сайте минут в предыдущем и текущем месяцах, а также доля акционных покупок и среднемесячное значение маркетинговых коммуникаций на одного покупателя.
При этом высокие значения количества проведенных на сайте минут и среднемесячного количества маркетинговых коммуникаций говорят о высокой вероятности того, что активность покупателя останется прежней.
Высокое же значение доли акционных покупок говорит о высокой вероятности того, что активность покупателя снизится.

### Результаты анализа сегментации покупателей и рекомендации для выбранного сегмента
Рассмотрели сегментацию покупателей по двум параметрам - прибыль от покупателя за последние 3 месяца превышает 5, но активность покупателя снизилась. В нашем сегменте 73 покупателя, при этом только 53 разрешают коммуникации.
Для этой группы покупателей мы рассмотрели статистику ранее определенных ключевых параметров - тех, которые наиболее сильно влияют на результат предсказания целевого показателя "активность" покупателя.
Средние значения параметров "страниц за визит" и "количество минут на сайте" для выбранного сегмента покупателей ниже средних значений этих параметров для всех покупателей.
Среднее значения параметра "акционные покупки" для выбранного сегмента покупателей наоборот выше среднего этого параметра для всех покупателей.
Среднее количество коммуникаций за последние 6 месяцев для выбранного сегмента покупателей такое же, как и для всех покупателей.

## Общие Рекомендации
Что предлагается сделать, чтобы увеличить активность покупателей из рассматриваемого сегмента.
Надо увеличить количество коммуникаций с ними (с теми из них, кто разрешает коммуникации). При этом это должны быть предложения любого характера, кроме акционных предложений со снижением цен. Например, можно предлагать акцию на наборы товаров, а не на отдельные товары со сниженным предложением цены. Это приведет к увеличению значений параметров "страниц за визит" и "количество минут на сайте", которые положительно влияют на показатель активности покупателей и возможно приведет к уменьшению доли акционных покупок.
